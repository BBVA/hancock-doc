(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{342:function(e,t,a){"use strict";a.r(t);var r=a(37),n=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"hancock-dlt-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hancock-dlt-broker","aria-hidden":"true"}},[e._v("#")]),e._v(" Hancock DLT Broker")]),e._v(" "),a("p",[e._v("Microservice belonging to Hancock's ecosystem which creates a subscription to the blockchain\nwatching for events related with some addresses or smart contracts.")]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation","aria-hidden":"true"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("Because blockchain is an event-based system, data writing is asynchronous. To facilitate third parties to manage these events, a service that allows standardized subscription through a client-server socket is required, thus serving the changes detected in the ledger by means of said socket.")]),e._v(" "),a("h2",{attrs:{id:"proposed-change"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proposed-change","aria-hidden":"true"}},[e._v("#")]),e._v(" Proposed Change")]),e._v(" "),a("p",[e._v("The service will connect to the blockchain when a client connects to the websocket exposed by the service.")]),e._v(" "),a("p",[e._v("The blockchain will be specified in the request by query-param. The fields allowed for the filter are a sender address and/or a contract address. If a sender address is specified, all pending transaction events related to the sender will be captured. If a contract address is specified, all the events programmed in it will be captured. It is mandatory specify at least one filter.")]),e._v(" "),a("p",[e._v("When an event is triggered in the blockchain that meets the requirements of the filter, the service will capture and launch it to the connected client that started the connection through websocket.")]),e._v(" "),a("h2",{attrs:{id:"current-blockchains-supported"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#current-blockchains-supported","aria-hidden":"true"}},[e._v("#")]),e._v(" Current blockchains supported")]),e._v(" "),a("ul",[a("li",[e._v("Ethereum")])]),e._v(" "),a("h2",{attrs:{id:"building-the-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-the-service","aria-hidden":"true"}},[e._v("#")]),e._v(" Building the service")]),e._v(" "),a("p",[e._v("Clone the project:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Clone the project ")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" clone https://github.com/BBVA/hancock-dlt-broker.git\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cd")]),e._v(" kst-hancock-ms-dlt-broker\n")])])]),a("p",[e._v("With node and npm or yarn:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# With npm")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run build:ts\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run serve:prod\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# With yarn")]),e._v("\n  yarn "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v("\n  yarn run build:ts\n  yarn run serve:prod\n")])])]),a("p",[e._v("With "),a("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Build the docker image")]),e._v("\n  docker build -t hancock_dlt_broker "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v(".")]),e._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Run the docker container")]),e._v("\n  docker run -d -it --name -p 80:80 hancock_dlt_broker_container hancock_dlt_broker\n")])])]),a("h2",{attrs:{id:"setting-up-the-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-service","aria-hidden":"true"}},[e._v("#")]),e._v(" Setting up the service")]),e._v(" "),a("p",[e._v("Once we have built the service, we need to configure a few things before launching it. You can find all environment vars\navailable to configure the service in "),a("a",{attrs:{href:"https://github.com/BBVA/hancock-dlt-broker/blob/master/config/custom-environment-variables.yaml",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("config/custom-environment-variables.yaml")]),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("An example of configuration of the most important vars:")]),e._v(" "),a("ul",[a("li",[e._v("Ethereum rpc node:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_BLOCKCHAIN_ETHEREUM_PROTOCOL"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_BLOCKCHAIN_ETHEREUM_HOST"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"52.80.128.77"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_BLOCKCHAIN_ETHEREUM_PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"34774"')]),e._v("\n")])])]),a("ul",[a("li",[e._v("Mongo ddbb host:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_DB_HOSTS"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"localhost:27017"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_DB_DATABASE"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hancock"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("export")]),e._v(" HANCOCK_DB_ETHEREUM_DATABASE"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hancock_eth"')]),e._v("\n")])])]),a("h2",{attrs:{id:"using-the-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-the-service","aria-hidden":"true"}},[e._v("#")]),e._v(" Using the service")]),e._v(" "),a("p",[e._v("The Hancock broker service is accessible by an standard web socket interface. You can test it in a browser console.")]),e._v(" "),a("p",[e._v("To know more, consult "),a("a",{attrs:{href:"./Options/"}},[e._v("Broker options")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"api-documentation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api-documentation","aria-hidden":"true"}},[e._v("#")]),e._v(" API documentation")]),e._v(" "),a("p",[e._v("Documentation about the async API can be found in "),a("a",{attrs:{href:"https://bbva.github.io/hancock-dlt-broker/api.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("this link"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"contribution-guidelines"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contribution-guidelines","aria-hidden":"true"}},[e._v("#")]),e._v(" Contribution guidelines")]),e._v(" "),a("p",[e._v("If you are thinking about contributing to the project, you should know that:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("The code has been written following the "),a("a",{attrs:{href:"https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("clean architecture principles"),a("OutboundLink")],1),e._v(", as well as "),a("a",{attrs:{href:"https://es.wikipedia.org/wiki/SOLID",target:"_blank",rel:"noopener noreferrer"}},[e._v("SOLID design principles"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("The project is built in "),a("a",{attrs:{href:"https://www.typescriptlang.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("typescript"),a("OutboundLink")],1),e._v(" v2.9.2 using the "),a("a",{attrs:{href:"https://github.com/palantir/tslint/blob/master/src/configs/recommended.ts",target:"_blank",rel:"noopener noreferrer"}},[e._v("recommended guidelines"),a("OutboundLink")],1),e._v(". Also there is a linter rules configured to follow this guidelines, so you can search for a plugin for your favourite IDE to be warned about this linter errors.")])])])])},[],!1,null,null,null);t.default=n.exports}}]);