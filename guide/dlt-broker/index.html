<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hancock DLT Broker | Hancock</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/hancock-doc/assets/css/0.styles.f72bef6a.css" as="style"><link rel="preload" href="/hancock-doc/assets/js/app.28931f4a.js" as="script"><link rel="preload" href="/hancock-doc/assets/js/4.b7600f4f.js" as="script"><link rel="preload" href="/hancock-doc/assets/js/2.80b219c5.js" as="script"><link rel="preload" href="/hancock-doc/assets/js/18.67a4a1bb.js" as="script"><link rel="prefetch" href="/hancock-doc/assets/js/10.269ab162.js"><link rel="prefetch" href="/hancock-doc/assets/js/11.b8bf3ea7.js"><link rel="prefetch" href="/hancock-doc/assets/js/12.c34c027f.js"><link rel="prefetch" href="/hancock-doc/assets/js/13.22f4cec8.js"><link rel="prefetch" href="/hancock-doc/assets/js/14.e00c2b92.js"><link rel="prefetch" href="/hancock-doc/assets/js/15.ea9815ee.js"><link rel="prefetch" href="/hancock-doc/assets/js/16.1b000b63.js"><link rel="prefetch" href="/hancock-doc/assets/js/17.5afbafaa.js"><link rel="prefetch" href="/hancock-doc/assets/js/19.ddd3b5d4.js"><link rel="prefetch" href="/hancock-doc/assets/js/20.38b4f3bc.js"><link rel="prefetch" href="/hancock-doc/assets/js/21.75b09490.js"><link rel="prefetch" href="/hancock-doc/assets/js/22.930dc03f.js"><link rel="prefetch" href="/hancock-doc/assets/js/23.572b4ed3.js"><link rel="prefetch" href="/hancock-doc/assets/js/24.2d6cc0ee.js"><link rel="prefetch" href="/hancock-doc/assets/js/25.dc9054c3.js"><link rel="prefetch" href="/hancock-doc/assets/js/26.67a87c8d.js"><link rel="prefetch" href="/hancock-doc/assets/js/27.938a2397.js"><link rel="prefetch" href="/hancock-doc/assets/js/28.fff62550.js"><link rel="prefetch" href="/hancock-doc/assets/js/29.4d3f946c.js"><link rel="prefetch" href="/hancock-doc/assets/js/3.1aba4a82.js"><link rel="prefetch" href="/hancock-doc/assets/js/30.d0fab01e.js"><link rel="prefetch" href="/hancock-doc/assets/js/5.41b26b68.js"><link rel="prefetch" href="/hancock-doc/assets/js/6.5169a9fe.js"><link rel="prefetch" href="/hancock-doc/assets/js/7.a5e9ce82.js"><link rel="prefetch" href="/hancock-doc/assets/js/8.63216889.js"><link rel="prefetch" href="/hancock-doc/assets/js/9.3b38d00f.js">
    <link rel="stylesheet" href="/hancock-doc/assets/css/0.styles.f72bef6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar navbar-vuepress"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hancock-doc/" class="home-link router-link-active"><img src="/hancock-doc/logo.svg" alt="Hancock" class="logo"> <!----></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hancock-doc/" class="nav-link">Home</a></div><div class="nav-item"><a href="/hancock-doc/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://github.com/BBVA?utf8=%E2%9C%93&amp;q=hancock" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hancock-doc/" class="nav-link">Home</a></div><div class="nav-item"><a href="/hancock-doc/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://github.com/BBVA?utf8=%E2%9C%93&amp;q=hancock" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/hancock-doc/guide/" class="sidebar-heading clickable router-link-active"><span>Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/hancock-doc/guide/dlt-adapter/" class="sidebar-heading clickable"><span>DLT Adapter</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/hancock-doc/guide/wallet-hub" class="sidebar-heading clickable"><span>Wallet Hub</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/hancock-doc/guide/dlt-broker/" class="sidebar-heading clickable router-link-exact-active router-link-active open active"><span>DLT Broker</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/hancock-doc/guide/dlt-broker/" class="active sidebar-link">Description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#motivation" class="sidebar-link">Motivation</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#proposed-change" class="sidebar-link">Proposed Change</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#current-blockchains-supported" class="sidebar-link">Current blockchains supported</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#building-the-service" class="sidebar-link">Building the service</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#setting-up-the-service" class="sidebar-link">Setting up the service</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#using-the-service" class="sidebar-link">Using the service</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#api-documentation" class="sidebar-link">API documentation</a></li><li class="sidebar-sub-header"><a href="/hancock-doc/guide/dlt-broker/#contribution-guidelines" class="sidebar-link">Contribution guidelines</a></li></ul></li><li><a href="/hancock-doc/guide/dlt-broker/Options/" class="sidebar-link">Options</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/hancock-doc/guide/sdk/" class="sidebar-heading clickable"><span>SDK</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="hancock-dlt-broker"><a href="#hancock-dlt-broker" aria-hidden="true" class="header-anchor">#</a> Hancock DLT Broker</h1> <p>Microservice belonging to Hancock's ecosystem which creates a subscription to the blockchain
watching for events related with some addresses or smart contracts.</p> <h2 id="motivation"><a href="#motivation" aria-hidden="true" class="header-anchor">#</a> Motivation</h2> <p>Because blockchain is an event-based system, data writing is asynchronous. To facilitate third parties to manage these events, a service that allows standardized subscription through a client-server socket is required, thus serving the changes detected in the ledger by means of said socket.</p> <h2 id="proposed-change"><a href="#proposed-change" aria-hidden="true" class="header-anchor">#</a> Proposed Change</h2> <p>The service will connect to the blockchain when a client connects to the websocket exposed by the service.</p> <p>The blockchain will be specified in the request by query-param. The fields allowed for the filter are a sender address and/or a contract address. If a sender address is specified, all pending transaction events related to the sender will be captured. If a contract address is specified, all the events programmed in it will be captured. It is mandatory specify at least one filter.</p> <p>When an event is triggered in the blockchain that meets the requirements of the filter, the service will capture and launch it to the connected client that started the connection through websocket.</p> <h2 id="current-blockchains-supported"><a href="#current-blockchains-supported" aria-hidden="true" class="header-anchor">#</a> Current blockchains supported</h2> <ul><li>Ethereum</li></ul> <h2 id="building-the-service"><a href="#building-the-service" aria-hidden="true" class="header-anchor">#</a> Building the service</h2> <p>Clone the project:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>  <span class="token comment"># Clone the project </span>
  <span class="token function">git</span> clone https://github.com/BBVA/hancock-dlt-broker.git
  <span class="token function">cd</span> kst-hancock-ms-dlt-broker
</code></pre></div><p>With node and npm or yarn:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>  <span class="token comment"># With npm</span>
  <span class="token function">npm</span> <span class="token function">install</span>
  <span class="token function">npm</span> run build:ts
  <span class="token function">npm</span> run serve:prod

  <span class="token comment"># With yarn</span>
  yarn <span class="token function">install</span>
  yarn run build:ts
  yarn run serve:prod
</code></pre></div><p>With <a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">docker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>  <span class="token comment"># Build the docker image</span>
  docker build -t hancock_dlt_broker <span class="token keyword">.</span>

  <span class="token comment"># Run the docker container</span>
  docker run -d -it --name -p 80:80 hancock_dlt_broker_container hancock_dlt_broker
</code></pre></div><h2 id="setting-up-the-service"><a href="#setting-up-the-service" aria-hidden="true" class="header-anchor">#</a> Setting up the service</h2> <p>Once we have built the service, we need to configure a few things before launching it. You can find all environment vars
available to configure the service in <a href="https://github.com/BBVA/hancock-dlt-broker/blob/master/config/custom-environment-variables.yaml" target="_blank" rel="noopener noreferrer"><code>config/custom-environment-variables.yaml</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>An example of configuration of the most important vars:</p> <ul><li>Ethereum rpc node:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>  <span class="token function">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_PROTOCOL<span class="token operator">=</span><span class="token string">&quot;http&quot;</span>
  <span class="token function">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_HOST<span class="token operator">=</span><span class="token string">&quot;52.80.128.77&quot;</span>
  <span class="token function">export</span> HANCOCK_BLOCKCHAIN_ETHEREUM_PORT<span class="token operator">=</span><span class="token string">&quot;34774&quot;</span>
</code></pre></div><ul><li>Mongo ddbb host:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>  <span class="token function">export</span> HANCOCK_DB_HOSTS<span class="token operator">=</span><span class="token string">&quot;localhost:27017&quot;</span>
  <span class="token function">export</span> HANCOCK_DB_DATABASE<span class="token operator">=</span><span class="token string">&quot;hancock&quot;</span>
  <span class="token function">export</span> HANCOCK_DB_ETHEREUM_DATABASE<span class="token operator">=</span><span class="token string">&quot;hancock_eth&quot;</span>
</code></pre></div><h2 id="using-the-service"><a href="#using-the-service" aria-hidden="true" class="header-anchor">#</a> Using the service</h2> <p>The Hancock broker service is accessible by an standard web socket interface. You can test it in a browser console.</p> <p>To know more, consult <a href="./Options/">Broker options</a>.</p> <h2 id="api-documentation"><a href="#api-documentation" aria-hidden="true" class="header-anchor">#</a> API documentation</h2> <p>Documentation about the async API can be found in <a href="https://bbva.github.io/hancock-dlt-broker/api.html" target="_blank" rel="noopener noreferrer">this link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="contribution-guidelines"><a href="#contribution-guidelines" aria-hidden="true" class="header-anchor">#</a> Contribution guidelines</h2> <p>If you are thinking about contributing to the project, you should know that:</p> <ul><li><p>The code has been written following the <a href="https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener noreferrer">clean architecture principles<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, as well as <a href="https://es.wikipedia.org/wiki/SOLID" target="_blank" rel="noopener noreferrer">SOLID design principles<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></li> <li><p>The project is built in <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener noreferrer">typescript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> v2.9.2 using the <a href="https://github.com/palantir/tslint/blob/master/src/configs/recommended.ts" target="_blank" rel="noopener noreferrer">recommended guidelines<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Also there is a linter rules configured to follow this guidelines, so you can search for a plugin for your favourite IDE to be warned about this linter errors.</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/hancock-doc/guide/wallet-hub/Operations/" class="prev">
          Operations
        </a></span> <span class="next"><a href="/hancock-doc/guide/dlt-broker/Options/">
          Options
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hancock-doc/assets/js/app.28931f4a.js" defer></script><script src="/hancock-doc/assets/js/4.b7600f4f.js" defer></script><script src="/hancock-doc/assets/js/2.80b219c5.js" defer></script><script src="/hancock-doc/assets/js/18.67a4a1bb.js" defer></script>
  </body>
</html>
